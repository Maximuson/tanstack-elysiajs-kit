# AI Context Documentation

## Project Overview

- **Name**: tanstack-elysiajs-learn
- **Description**: A learning project combining TanStack Start (full-stack React framework) with ElysiaJS for backend API handling.
- **Tech Stack**:
  - **Framework**: TanStack Start (Beta/Early Access)
  - **Router**: TanStack Router (File-based routing)
  - **Frontend**: React 19
  - **Backend**: ElysiaJS (mounted as a route handler) & TanStack Start Server Functions
  - **Styling**: Tailwind CSS v4
  - **Bundler**: Vite
  - **Language**: TypeScript

## Architecture & Patterns

### 1. Routing

- **File-Based Routing**: All routes are defined in `src/routes`.
- **Root Layout**: `src/routes/__root.tsx` defines the global HTML shell, `<head>`, and `Header`.
- **Generated Routes**: `src/routeTree.gen.ts` is auto-generated by TanStack Router.

### 2. Backend & Data Fetching

The project demonstrates two primary ways to handle backend logic:

#### A. ElysiaJS API (`src/routes/api.$.ts`)

- An Elysia app is instantiated and handled via a wildcard route `api/$`.
- This creates a standard REST API endpoint at `/api/*`.
- **Eden Treaty**: Type-safe client export `getTreaty` allows the frontend to call the API with full type safety.

#### B. Server Functions (`src/routes/demo/start.server-funcs.tsx`)

- Uses `createServerFn` from `@tanstack/react-start`.
- These functions run on the server but can be called directly from the client (RPC-style).
- Example: `getTodos` (GET) and `addTodo` (POST).
- **Loader Pattern**: `Route.useLoaderData()` avoids waterfall fetches by preloading data in the route definition.
  ```typescript
  export const Route = createFileRoute("/path")({
    loader: async () => await serverFn(),
    component: MyComponent,
  });
  ```

### 3. Styling

- **Tailwind CSS v4**: Configured via `@tailwindcss/vite` plugin in `vite.config.ts`.
- **Global Styles**: Imported in `src/routes/__root.tsx` from `src/styles.css`.

## Directory Structure

- `src/`
  - `components/`: Reusable UI components (e.g., `Header.tsx`).
  - `routes/`: Application routes.
    - `api.$.ts`: Main Elysia API entry point.
    - `demo/`: Example implementations (server functions, API requests).
    - `__root.tsx`: Top-level layout.
  - `router.tsx`: Router instance creation.

## Key Configuration Files

- `package.json`: Dependencies (React 19, TanStack packages, Elysia).
- `vite.config.ts`: Vite plugins (TanStack Start, DevTools, Tailwind, Nitro).
- `tsconfig.json`: TypeScript configuration.

## Development Commands

- `bun run dev`: Starts the dev server (port 3000).
- `bun run build`: Builds for production.
- `bun run preview`: Previews the build.

## Important Notes for AI Agents

- **Server Functions**: When adding backend logic for UI components, prefer `createServerFn` for tighter integration.
- **Elysia API**: Use `src/routes/api.$.ts` for standalone API endpoints (e.g., webhooks, public API) or when leveraging Elysia's specific features.
- **React 19**: Be aware of React 19 features (although this project uses standard hooks so far).
